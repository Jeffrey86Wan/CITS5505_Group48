{% extends "components/dashboard_base.html" %} {% block title %}QuickNote - Add Record{% endblock %} {% block dashboard_content %}
<h2 class="text-2xl font-bold text-gray-800 mb-6">Add Record</h2>

<div class="bg-white rounded-lg">
    <div class="mb-6">
        <div class="flex space-x-4 mb-6">
            <button class="py-2 px-6 bg-red-50 text-red-600 rounded-full font-medium hover:bg-red-100 transition duration-200 focus:outline-none" id="btn-expense" type="button">Expense</button>
            <button class="py-2 px-6 bg-gray-100 text-gray-600 rounded-full font-medium hover:bg-gray-200 transition duration-200 focus:outline-none" id="btn-income" type="button">Income</button>
        </div>
    </div>

    <form method="POST" action="{{ url_for('record.index') }}">
        <div class="space-y-6 max-w-3xl">
            <!-- Amount -->
            <div>
                <label class="block text-gray-700 text-sm font-medium mb-2">Amount</label>
                <div class="relative">
                    <span class="absolute left-3 top-3 text-gray-500">Â¥</span>
                    <input type="number" name="amount" step="0.01" class="form-input pl-8 py-3 w-full border-gray-300 rounded-lg focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-20" placeholder="0.00" required />
                </div>
            </div>

            <!-- Date -->
            <div>
                <label class="block text-gray-700 text-sm font-medium mb-2">Date</label>
                <input type="date" name="date" class="form-input py-3 w-full border-gray-300 rounded-lg focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-20" required />
            </div>

            <!-- Category -->
            <div>
                <label class="block text-gray-700 text-sm font-medium mb-2">Category</label>
                <div id="expense-categories" class="grid grid-cols-4 gap-4">
                    {% for category in expense_categories %}
                    <div class="p-4 border border-gray-200 rounded-lg text-center hover:border-primary hover:bg-primary-light cursor-pointer transition duration-200 category-item" data-category-id="{{ category.id }}" data-category-type="expense">
                        <div class="h-12 w-12 rounded-full flex items-center justify-center mx-auto mb-2" style="background-color: '{{ category.color or '#F3F4F6' }}'">
                            <i class="fas {{ category.icon or 'fa-tag' }} text-{{ category.color.split('#')[1][:3] }}-500"></i>
                        </div>
                        <span class="text-gray-700">{{ category.name }}</span>
                    </div>
                    {% endfor %}
                </div>

                <div id="income-categories" class="grid grid-cols-4 gap-4 hidden">
                    {% for category in income_categories %}
                    <div class="p-4 border border-gray-200 rounded-lg text-center hover:border-primary hover:bg-primary-light cursor-pointer transition duration-200 category-item" data-category-id="{{ category.id }}" data-category-type="income">
                        <div class="h-12 w-12 rounded-full flex items-center justify-center mx-auto mb-2" style="background-color: '{{ category.color or '#F3F4F6' }}'">
                            <i class="fas {{ category.icon or 'fa-tag' }} text-{{ category.color.split('#')[1][:3] }}-500"></i>
                        </div>
                        <span class="text-gray-700">{{ category.name }}</span>
                    </div>
                    {% endfor %}
                </div>

                <input type="hidden" id="category_id" name="category_id" value="" />
                <input type="hidden" id="transaction_type" name="type" value="expense" />
            </div>

            <!-- Description -->
            <div>
                <label class="block text-gray-700 text-sm font-medium mb-2">Description</label>
                <input type="text" name="description" class="form-input py-3 w-full border-gray-300 rounded-lg focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-20" placeholder="Add a brief description..." />
            </div>

            <!-- Submit button -->
            <div class="text-center">
                <button type="submit" class="bg-primary text-white px-8 py-3 rounded-lg font-medium hover:bg-opacity-90 transition duration-200">Save</button>
            </div>
        </div>
    </form>
</div>
{% endblock %} {% block scripts %}
<script>
    document.addEventListener("DOMContentLoaded", function () {
        const btnExpense = document.getElementById("btn-expense");
        const btnIncome = document.getElementById("btn-income");
        const expenseCategories = document.getElementById("expense-categories");
        const incomeCategories = document.getElementById("income-categories");
        const categoryIdInput = document.getElementById("category_id");
        const transactionTypeInput = document.getElementById("transaction_type");

        // Expense/Income toggle
        btnExpense.addEventListener("click", function () {
            btnExpense.classList.remove("bg-gray-100", "text-gray-600");
            btnExpense.classList.add("bg-red-50", "text-red-600");

            btnIncome.classList.remove("bg-green-50", "text-green-600");
            btnIncome.classList.add("bg-gray-100", "text-gray-600");

            // Show expense categories, hide income categories
            expenseCategories.classList.remove("hidden");
            incomeCategories.classList.add("hidden");

            // Update transaction type
            transactionTypeInput.value = "expense";
        });

        btnIncome.addEventListener("click", function () {
            btnIncome.classList.remove("bg-gray-100", "text-gray-600");
            btnIncome.classList.add("bg-green-50", "text-green-600");

            btnExpense.classList.remove("bg-red-50", "text-red-600");
            btnExpense.classList.add("bg-gray-100", "text-gray-600");

            // Show income categories, hide expense categories
            incomeCategories.classList.remove("hidden");
            expenseCategories.classList.add("hidden");

            // Update transaction type
            transactionTypeInput.value = "income";
        });

        // Category selection
        const categoryItems = document.querySelectorAll(".category-item");
        categoryItems.forEach((item) => {
            item.addEventListener("click", function () {
                // Remove selected style from all categories
                categoryItems.forEach((cat) => {
                    cat.classList.remove("border-primary", "bg-primary-light");
                });

                // Add selected style to current category
                this.classList.add("border-primary", "bg-primary-light");

                // Update hidden input field value
                console.log("Selected category:", this.dataset.categoryId);
                categoryIdInput.value = this.dataset.categoryId;
            });
        });

        // Form submission debugging
        document.querySelector("form").addEventListener("submit", function (e) {
            console.log("Form submitting...");
            console.log("Category ID:", document.getElementById("category_id").value);
            console.log("Transaction type:", document.getElementById("transaction_type").value);
            console.log("Amount:", document.querySelector('input[name="amount"]').value);
            console.log("Date:", document.querySelector('input[name="date"]').value);
        });
    });
</script>
{% endblock %}
